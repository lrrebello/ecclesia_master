{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card border-0 shadow-sm p-4">
            <h3 class="fw-bold mb-4">Editar Congregação</h3>
            <form method="POST" enctype="multipart/form-data">
                <div class="mb-3">
                    <label class="form-label small fw-bold">NOME DA CONGREGAÇÃO</label>
                    <input type="text" name="name" class="form-control bg-light border-0" value="{{ church.name }}" required>
                </div>
                <div class="mb-3">
                    <label class="form-label small fw-bold">ENDEREÇO</label>
                    <input type="text" name="address" class="form-control bg-light border-0" value="{{ church.address or '' }}" >
                </div>
                <div class="mb-3">
                    <label class="form-label small fw-bold">CIDADE</label>
                    <input type="text" name="city" class="form-control bg-light border-0" value="{{ church.city or '' }}">
                </div>
                <div class="mb-3">
                    <label class="form-label small fw-bold">PAÍS</label>
                    <select name="country" class="form-select bg-light border-0" required>
                        <option value="Portugal" {{ 'selected' if church.country == 'Portugal' }}>Portugal</option>
                        <option value="Brasil" {{ 'selected' if church.country == 'Brasil' }}>Brasil</option>
                        <option value="Espanha" {{ 'selected' if church.country == 'Espanha' }}>Espanha</option>
                        <option value="França" {{ 'selected' if church.country == 'França' }}>França</option>
                        <option value="Alemanha" {{ 'selected' if church.country == 'Alemanha' }}>Alemanha</option>
                        <option value="Itália" {{ 'selected' if church.country == 'Itália' }}>Itália</option>
                        <option value="Irlanda" {{ 'selected' if church.country == 'Irlanda' }}>Irlanda</option>
                        <option value="Bélgica" {{ 'selected' if church.country == 'Bélgica' }}>Bélgica</option>
                        <option value="Outro" {{ 'selected' if church.country == 'Outro' }}>Outro</option>
                    </select>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">NIF / Nº CONTRIBUINTE</label>
                        <input type="text" name="nif" class="form-control bg-light border-0" value="{{ church.nif or '' }}" placeholder="Ex: 517760010">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">E-MAIL FISCAL / CONTATO</label>
                        <input type="email" name="email" class="form-control bg-light border-0" value="{{ church.email or '' }}" placeholder="Ex: financeiro@igreja.com">
                    </div>
                    <div class="mb-3">
                        <label class="form-label small fw-bold">LOGO DA CONGREGAÇÃO</label>
                        {% if church.logo_path %}
                        <img src="{{ url_for('static', filename=church.logo_path) }}" alt="Logo atual" class="img-thumbnail mb-2" style="max-height: 100px;">
                        <small class="text-muted d-block mb-2">Logo atual. Envie um novo para substituir.</small>
                        {% endif %}
                        <input type="file" name="logo" class="form-control bg-light border-0" accept="image/*">
                        <small class="text-muted">Formatos: JPG, PNG, GIF. Tamanho máx: 2MB.</small>
                    </div>
                </div>

                <hr class="my-4">
                <h5 class="fw-bold mb-3"><i class="bi bi-card-id me-2"></i>Arte do Cartão de Membro</h5>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">FRENTE DO CARTÃO (85.6mm x 54mm)</label>
                        {% if church.member_card_front %}
                        <img src="{{ url_for('static', filename=church.member_card_front) }}" alt="Frente atual" class="img-thumbnail mb-2" style="max-height: 120px;">
                        <small class="text-muted d-block mb-2">Frente atual. Envie uma nova para substituir.</small>
                        {% endif %}
                        <input type="file" name="member_card_front" class="form-control bg-light border-0" accept="image/*">
                        <small class="text-muted">Formatos: JPG, PNG. Tamanho máx: 5MB. Dimensões: 85.6mm x 54mm (300 DPI).</small>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label small fw-bold">VERSO DO CARTÃO (85.6mm x 54mm)</label>
                        {% if church.member_card_back %}
                        <img src="{{ url_for('static', filename=church.member_card_back) }}" alt="Verso atual" class="img-thumbnail mb-2" style="max-height: 120px;">
                        <small class="text-muted d-block mb-2">Verso atual. Envie um novo para substituir.</small>
                        {% endif %}
                        <input type="file" name="member_card_back" class="form-control bg-light border-0" accept="image/*">
                        <small class="text-muted">Formatos: JPG, PNG. Tamanho máx: 5MB. Dimensões: 85.6mm x 54mm (300 DPI).</small>
                    </div>
                </div>
                <div class="alert alert-info small mt-3">
                    <i class="bi bi-info-circle me-2"></i><strong>Dica:</strong> As artes devem ser preparadas com espaços em branco para os dados do membro (nome, foto, cargo, etc). O sistema posicionará automaticamente as informações sobre sua arte.
                </div>
                <div class="form-check mb-4">
                    <input type="checkbox" name="is_main" class="form-check-input" id="is_main" {{ 'checked' if church.is_main }}>
                    <label class="form-check-label" for="is_main">É a congregação principal (sede)</label>
                </div>
                <div class="d-grid mt-4">
                    <button type="submit" class="btn btn-primary btn-lg py-3 fw-bold shadow-sm">
                        Salvar Alterações
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}